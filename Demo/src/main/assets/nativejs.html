<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="author" content="heyan">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1, target-densitydpi=medium-dpi, user-scalable=no">
    <title>JS和原生交互</title>
    <style>
        ul {list-style-type: none;}
        ul li {float: left;width: 100%;height: 60px;border-bottom: 1px solid #CCCCCC;}
        body {text-align: center;}
        input,button {margin-top: 10px;width:100%;padding-top:10px;padding-bottom:10px;}
    </style>
    <script type="text/javascript" src="jquery-1.12.4.min.js"></script>
</head>
<body>
<button onClick="test();">测试</button>
<button onClick="getAndJs().closeWindow();">关闭当前页面 closeWindow</button>
<button onClick="getAndJs().alert('提示一下');">气泡提示 alert</button>
<button onClick="appConfirm('提示','提示一下',null,null,true);">确认对话框 confirm</button>
<button onClick="appConfirm('提示','提示一下');">确认取消对话框 confirm</button>
<button onClick="appConfirm('提示','提示一下',null,null,null,function(){getAndJs().alert('你点了确定按钮');});">
    确认取消对话框-确认回调 confirm
</button>
<button onClick="appConfirm('提示','提示一下',null,null,null,function(){getAndJs().alert('你点了确定按钮');},function(){getAndJs().alert('你点了取消按钮');});">
    确认取消对话框-确认取消回调 confirm
</button>
<button onClick="appConfirm('提示','提示一下','保存',null,null,function(){getAndJs().alert('你点了保存按钮');},function(){getAndJs().alert('你点了取消按钮');});">
    确认取消对话框-保存取消回调 confirm
</button>
<button onClick="checkAppInfo();">获取系统信息</button>
<button onClick="checkLocationInfo();">获取定位信息</button>
<button onClick="checkStatusBarHeight();">获取状态栏高度</button>
<button onClick="checkTitleBarHeight();">获取标题栏高度</button>
<button onClick="getAndJs().showLoading('加载中...');">显示加载对话框</button>
<button onClick="getAndJs().closeLoading();">关闭加载对话框</button>
<button onClick="getAndJs().showLayer({'width':0.8,'height':0.6,'path':'http://m.baidu.com'},function(){getAndJs().alert('你点了确定按钮');});">
    打开网页提示框
</button>
<button type="button" onClick="getAndJs().alert(getAndJs().getHeaderStr())">获取头信息</button>
<button type="button" onClick="testShowImages();">图片浏览</button>
<button type="button" onClick="testShowImagesIndex();">图片浏览指定</button>
<button type="button" onClick="getAndJs().showLocation('位置','31.076144','103.546591');">显示指定定位
</button>
<button type="button" onClick="getAndJs().openNavi('导航','31.076144','103.546591');">显示导航</button>
<button type="button" onClick="testCacheSave();">缓存存储</button>
<button type="button" onClick="testCacheGet();">缓存获取</button>
<button type="button" onClick="getAndJs().openRefresh();">开启刷新</button>
<button type="button" onClick="getAndJs().endRefresh();">结束刷新</button>
<button type="button" onClick="getAndJs().closeRefresh();">禁止刷新</button>
<input type="file" name="pic" id="pic" accept="image/*" />
</body>
<script type="text/javascript">
    function test(){
        var json = {"title":"测试","message":"内容","other":"其他"}
        alert(JSON.stringify(json).replace(/\,/g,',\n').replace(/\{|\}/g,''));
    }
    function getAndJs(){
        if(typeof(andJs) == "undefined"){
            alert("环境错误");
            return;
        }
        return andJs;
    }
    function alertJson(json){
        appConfirm("提示",JSON.stringify(json).replace(/\,/g,',\n').replace(/\{|\}/g,''));
    }
    function appConfirm(title,message,confirm,cancel,hideCancel,successCallback,cancelCallback){
        var json = {"title":title,"message":message}
        if(confirm)
            json["confirm"] = confirm;
        if(cancel)
            json["cancel"] = cancel;
        if(hideCancel)
            json["hideCancel"] = hideCancel;
        if(successCallback){
            if(cancelCallback)
                getAndJs().confirm(json, successCallback, cancelCallback);
            else
                getAndJs().confirm(json, successCallback);
        }else
            getAndJs().confirm(json);
    }
    function checkAppInfo(){
        var json = getAndJs().getDeviceInfo();
        if(json)
            alertJson(json);
    }
    function checkLocationInfo(){
        var json = getAndJs().getLocationInfo();
        if(json)
            alertJson(json);
        else
            getAndJs().alert("定位中...，请稍后重试");
    }
    function checkStatusBarHeight(){
        var height = getAndJs().getStatusBarHeight();
        appConfirm("提示","状态栏高度："+height);
    }
    function checkTitleBarHeight(){
        var height = getAndJs().getNavigationBarHeight();
        appConfirm("提示","标题栏高度："+height);
    }
    function checkAlipay(){
        getAndJs().showLoading("加载中...");
        getAndJs().toAlipay({
        "title":"测试支付",
        "desc":"测试哈哈",
        "order_no":"A20160616110932ce39cb8f000485105934",
        "money":"0.01",
        "callback":"http://test.imtoi.local",
        "rsa":"MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBAPKtE2AiukHV9Z6IqpL6sGe/lQ5O5TUdrOOn+b0c+HQkzRLN3qvYil2cpsyNJaPHyBEz6k9B8An+2ZShZd/1yxH4jcCUs8C/05u/C6hfc/f7xrY1x1o15OlEI1z9tiujiH71OPtdhhOC38Zmsx3wTqzsvr7PTiLaDg4RcZgt/H0jAgMBAAECgYEA40Do8BIVUinHRZq+Ab35DG8AatG/GyqbCOX4nPxQPpNn58AaUdsKV/emy88x/FnOJS30shwRaYravrEV8dD/RBYnehWBkfQG5mniSra7yXqdPu7ZrmoLVEJYRkkDqm9AUIifGtkhiwb4d3bZec9+FyTADJY8/hHJEE/zOiL/H0ECQQD5sX3mtNe1moDMhTQVfsv3/OKzDPEguMObtnQPbTXntM4KjR0b7Hs//cShwb3R116VFcN6L+wSpY5xvoKGa6V7AkEA+M416VRbbTIaoIgR+c7+1o9wQBoT5/+fHmMYraN+6B1OiYgylPlVWgs+DjhVp0SSfUWQ8EQ4r6b1e7642/fyeQJAB4sxPpMgIUB1u7gahru59dgSEU7GyjJK1p2AjCbEhieUQgVZZ8qRPrGwCyMLVReop+Bsc3iXLUkLMKyMzPrbmQJBAJYrwJZoeBZcW33xIwhoS6AtS08lbkZlHyE0Jr0HJZ3rsm+IaR9Jrp5+kqH6lpgy50f9KRIb2ysJ1rkt0F3UNeECQQDuZJhIt8A+wD+vva8ENzeEuwVaHct2W74q7TXxAauc/OXsKvuc29WXHkn0Fme5KTwZEiFRO5joat4x4/OiIm+R"},
        function(){
            getAndJs().closeLoading();
            getAndJs().alert("支付成功");
        },function(msg){
            getAndJs().closeLoading();
            getAndJs().alert(msg);
        });
    }
    var pics = {items:["http://b349.photo.store.qq.com/psb?/V114gsWl2NkwCr/ZjPfVJxU6yHiX8nGkHt*Mb*RbczZp.CzbFX3fAdFt8k!/b/dF0BAAAAAAAA&bo=vwOAAgAAAAAFAB0!&rf=viewer_4",
                "http://b167.photo.store.qq.com/psb?/V114gsWl1CYTqE/aJbVC*fxN8qILeRoc8l6pUxH*I2FYaZKLAq.f*F3dT8!/b/dHp7k2M3EQAA&bo=WAIgAwAAAAABAF4!&rf=viewer_4",
                "http://b214.photo.store.qq.com/psu?/V114gsWl1CYTqE/aR3VhyWfU*IGDZjwq33l56M1yOngYV9.1gwJze1UwjA!/b/YRH3k38SPAAAYsP6ln.lPQAA&bo=ngL2AQAAAAABAEw!&rf=viewer_4",
                "http://b150.photo.store.qq.com/psb?/V114gsWl4TI5sH/fMpXoycfQrB4pgaykz2vtJojhNUp0tFDUFUlhqAlF1A!/b/YZFkcVnbjwAAYqJ0d1l5lQAAb6J0d1l5lQAA&bo=AAKqAgACqgIBACc!&rf=viewer_4",
                "http://b153.photo.store.qq.com/psb?/0c05b32b-089b-4d3f-bced-087109337669/bLYAiYUAokrbNy8dqhAAFBeQGMaueVrMe*W8eUIl1.0!/b/YYIkO1ssBwAAYnkOOFvwCQAAb8uAM1uBCAAA&bo=WAIgA7AEQAYBAKw!&rf=viewer_4",
                "http://b152.photo.store.qq.com/psb?/0c05b32b-089b-4d3f-bced-087109337669/sWhtiYZviE.L50sPdQD31YY7H2boC66ge7xNIfHf5xI!/b/YfN7n1q.gAAAYuoRpFqCdAAA&bo=WAIfAwAAAAABAGE!&rf=viewer_4",
                "http://b212.photo.store.qq.com/psu?/0c05b32b-089b-4d3f-bced-087109337669/sncIu3LeivEyfhTO1vOB*OJm5fqfv4UxHq6y*vpmqnQ!/b/YVjNYn6rQgAAYvc.YX5JQgAA&bo=WAIgAwAAAAABAF4!&rf=viewer_4",
                "http://b58.photo.store.qq.com/psu?/0c05b32b-089b-4d3f-bced-087109337669/dPh7wMVMl.R7FSXyZhH8DZLR6*mC0amjjRffyOcgCvg!/b/Yaef*yGmZwAAYvD8pSJvagAAb9RYNh0NlQAA&a=57&b=58&o=49&bo=4AGAAuABgAIBACc!&rf=viewer_4"],
                position:0};
    function testShowImages(){
         getAndJs().showPictures(pics);
    }
    function testShowImagesIndex(){
        pics["position"]=3;
        getAndJs().showPictures(pics);
    }
    function testCacheSave(){
        var str = getAndJs().getCache("test");
        var json;
        if(str){
            json = JSON.parse(str);
            json.count ++;
        }else{
            json = {count:1,title:"缓存测试"};
        }
        getAndJs().setCache("test",JSON.stringify(json));
    }
    function testCacheGet(){
        var json = getAndJs().getCache("test");
        if(json){
            getAndJs().alert(json);
        }else{
            getAndJs().alert('没有数据');
        }
    }
    function loadMore(){
        getAndJs().alert('调用了加载更多');
    }
   function onRefresh(){
        getAndJs().alert('监听到了一个下拉刷新操作');
   }
</script>
</html>
